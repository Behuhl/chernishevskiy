# Инструкция текстологической работы по наследию Н. Г. Чернышевского

## Введение

В этом документе собраны инструкции по общей работе над оцифровкой полного собрания сочинений Н. Г. Чернышевского. 

## Хранение материалов

В данный момент для вычитки используется система контроля версий [Git](https://git-scm.com/book/ru/v2/Введение-О-системе-контроля-версий). Более подробно ознакомиться с работой системы можно по выше приведенной ссылке. При желании можно вкратце ознакомиться с чаще всего используемыми [терминами](https://recrutach.ru/github_3). 

Данная система позволяет группе людей работать над одним набором файлов. Система отслеживает изменения, вносимые каждым участником, и позволяет комбинировать их таким образом, чтобы избежать конфликтов версий. Такой конфликт представить не сложно. Допустим, что текстологи Василий и Андрей работают над одним и тем же томом. Андрей вычитывает и вносит поправки в первую часть тома, Василий - во вторую. Без использования сторонних систем Василию и Андрею придётся дополнительно потрудиться, а именно - из двух полуготовых файлов собрать один, в который будут внесены правки их обоих. Система Git делает это автоматически и таким образом экономит труд наших текстологов. Представьте, что редактуремый Василием и Андреем файл загружен на сервер. Василий и Андрей каждый копируют этот файл, и каждый вносит свои изменения в свою локальную копию. Далее они оба загружают свои версии файлов обратно на сервер. Система Git проверяет файлы - сравнивает их, обозначает их различия с основной версией файла на сервере. Оператор системы несколькими нажатиями клавиш подтверждает изменения, разрешает конфликты, если это необходимо, и обновленная версия файла становится основной, которую копируют уже следующие текстологи. 

Для работы системы Git нужен сервер на котором хранится текущая версия вычитываемого файла. В данный момент мы используем сервис GitHub, по адресу: https://github.com. Этот сервис требует регистрации и поэтому первый шаг - завести на нём учётную запись. 

После регистрации переходим по ссылке на наш [репозиторий](https://github.com/ZaryaXYZ/chernishevskiy/). Чтобы напрямую вносить изменения в репозиторий, вам должны быть выданы права редактирования основного репозитория. Такие права выдаются лишь проверенным участникам. Новым участникам нужно создать *форк*-репозиторий, или попросту говоря копию. Для этого нужно нажать на кнопку *Fork* в верхнем правом углу экрана:
![Создание форка](0.png).

На данном этапе вы уже можете редактировать текст и предлагать свои правки в основной репозиторий. Для этого нужно нажать на ссылку тома (заметьте, что редактировать файлы вы можете только в собственном форке. В каком точно репозитории вы находитесь можно понять посмотрев в верхний левый угол. Если вы находитесь в своём форке, то там будет написано *ВашНикнейм / chernishevskiy*. Если вы в основном репозитории, то там будет написано *ZaryaXYZ / chernishevsky*.) например *Т02*, выбрать редактируемый файл, например *2_005_092.md* перед вами откроется подобное окно:

![Редактирование на сайте](1_редактирование_на_сайте.png)

Нажав на символ карандаша, вы переходите в окно простенького текстового редактора. Внеся изменения, вы можете их зафиксировать нажав на *commit changes* (зафиксировать изменения). Перед этим вы можете выбрать вносить изменения в главную ветку репозитория (main branch) или для своих изменений создать новую ветку. В нашем случае, изменения внесены сразу в главную ветку форка. Если выбрать опцию создания новой ветки, то система автоматически создаст копию редактируемых файлов. Это может быть полезно в том случае если ваши изменения по той или иной причине не подойдут в основной репозиторий - тогда ветку можно просто удалить, а main вашего форка не будет отличаться от main основного репозитория.

![Внесение изменений](01.png)

Вы внесли изменения в вами созданую копию репозитория. Чтобы предложить эти изменения в основной репозиторий нужно создать *pull request*. Для этого возвращаемся в вкладку *Code* форка. Если изменения зафиксированы правильно, появится надпись, сообщающая о том, что ваша ветка (ваш форк) опережает основную ветку на 1 коммит. Чтобы предложить своё изменение в основной репозиторий, нажимаем *Contribute* и *Open pull request* в появившемся окне
![Создание пул реквеста](02.png)

Откроется окно, в котором будут обозначены внесённые вами изменения, а так же дополнительная информация о конфликтах версий. 
![Создание пул реквеста](03.png)

Нажимаем на *Create pull request*. В открывшемся текстовом окне заполняем информацию об изменении и ещё раз нажимаем на *Create pull request*.

![Создание пул реквеста](04.png)

Теперь в основном репозитории проекта, во вкладке *Pull requests* появится ваше изменения. Как только один из модераторов его просмотрит и примет ваши изменения будут внесены в основной проект. 

![Создание пул реквеста](05.png)

Так же важно следить, чтобы ваш форк-репозиторий не отставал от основного. Для этого его нужно регулярно обновлять. В любой момент открыв вкладку *Code* вашего форка вы можете увидеть, как он соотносится с основным репозиторием. В нашем примере, форк отстаёт на 4 коммита. Попросту говоря в основной репозиторий внесены 4 новых правки, которых нету в вашем репозитории. Для того, чтобы эти правки скопировать себе, нажимаем на *Fetch upstream* и далее на *Fetch and merge*.

![Обновление форка](06.png)

Обновления будут внесены в ваш форк. По окончанию процесса ваш форк вновь соответствует основному репозиторию. 

![Обновление форка](07.png)

Такое обновление следует делать каждый раз, когда вы начинаете вычитку нового отрывка. 

Более подробно редактирование через веб интерфейс описано здесь: https://starkovden.github.io/Pull-request-workflows.html

---

Хотя для мелких правок способ  редактирования через веб интерфейс вполне приемлем, работа с определённой разметкой (о том, что такое разметка, поговорим дальше) и большими объёмами текста легче осуществляется через специальные текстовые редакторы. Для того, чтобы использовать свой текстовый редактор, нам будет нужна локальная копия репозитория у себя на устройстве. Для создания и поддержания такой копии, нам пригодится программа GitHub Desktop. Её скачать можно по адрессу: https://desktop.github.com/. После установки нужно авторизироваться в программе используя логин и пароль, которые вы создали при регистрации на сайте github.

Для авторизации запускаем программу, в верхнем меню выбираем *File - Options - Accounts*. Во вкладке Github.com нажимаем *Sign in*. \[Если вы авторизовались при установке клиента, этот шаг можно пропустить\]

![Авторизация](08.png)

Вас попросят авторизоваться через браузер. Соглашаемся. В открывшемся окне браузера позволяем программе Github Desktop открыть ссылку.

![Авторизация](09.png)

Если всё прошло успешно, то перейдя в *File - Options - Accounts* вы будете видеть имя своей учётной записи на GitHub.

Когда программа установлена, можно приступать к "клонированию" нужного репозитория. Для этого выбираем в верхнем меню *File* пункт *Clone repository* или используем комбинацию клавиш Ctrl+Shift+O.

В появившемся окне выбираем вкладку URL, вводим адрес копируемого репозитория. Адрес своего форка можно найти на странице форка, нажав на зеленую кнопку *Code* и скопировав ссылку во вкладке *HTTPS*. 

![Выбор пути](10.png)

![Выбор пути](11.png)

После, нажимаем на "clone" и ждём пока репозиторий скачается на устройство. После этого появится окно диалога, спрашивающее для чего вы будете использовать репозиторий. Выбираем опцию *To contribute to the parent project*

![Настройки репозитория](12.png)

Теперь локальная копия вашего форк-репозитория доступна на вашем устройстве.

![Настройки репозитория](13.png)

Из главного окна программы вы можете открыть копию репозитория у вас на компьютере комбинацие клавиш *Ctrl+Shift+F* либо нажав на соответствующую кнопку в главном окне. 

Процесс внесения изменений схож с тем, каким образом изменения вносились в веб интерфейсе, с некоторыми отличиями. Для начала, своздаём новую ветку выбрав вкладку *Current branch - New Branch*.

![Внесение изменений](14.png)

Название можно выбрать любое. Обычно используется нумерация страниц вычитываемого отрывка, например 395_405 и т. п.

Заметьте, что после создания новой ветки *Current branch* сменилась с main на новую ветку. Во время работы вы можете свободно переключаться между ветками. Те изменения, которые вы вносите в новую ветку, не будут изменять вашу основную ветку. 

После создания новой ветки, нужно открыть вычитываемый отрывок, внести и сохранить в него изменения. Каждое изменение будет фиксироваться в программе. 

![Внесение изменений](15.png)

Вычитку можно проводить в один присест, или в несколько - это не имеет значения. Файл изменяется привычным образом - каждый раз закончив работу в редакторе, сохраняем изменения через *File - Save*.

Как только вычитка отрывка закончена, изменения нужно зафиксировать в программе. Для этого в левом нижнем углу экрана заполняем название, описываем сделанные в тексте изменения и нажимаем commit to *название ветки*

![Внесение изменений](16.png)

Теперь ваши изменения зафиксированы *в вашей копии репозитория*. Далее необходимо эти изменения внести в основной репозиторий. Как и в случае редактирования в веб интерфейсе, нужно создать *pull request*.

Чтобы создать пулл реквест, нужно сначала созданую ветку опубликовать на сервере гитхаба. Это сделать можно нажав на *Publish Branch* 

![Внесение изменений](17.png)

Теперь эта ветка видна в списке веток вашего форка. Но это нам не так важно. Создать пулл реквест можно прямо из программы. После публикации ветки на месте *publish branch* появляется *create pull request*. Нажатие на эту кнопку откроет окно браузера, идентичное тому, которое мы заполняли при создании пулл реквеста ранее.

![Внесение изменений](18.png)

Процесс тот же - заполняем информацию об вносимых изменениях, нажимаем зеленую кнопку *Create pull request* и ждём, пока ваши изменения одобрит модератор. 

Как только ваши изменения будут приняты, объединяем тестовую ветку и главную ветку на своём репозитории. Для этого переходим в ветку *main* и выбираем опцию *choose a branch to merge into main* 

![Внесение изменений](19.png)

Выбираем созданную ветку. Это внесёт ваши изменения в ваш основной каталог. 

Вот и весь процесс работы с системой Git и клиентом Github.
